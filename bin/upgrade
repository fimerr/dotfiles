#!/usr/bin/env zsh
#
### Upgrade software
###    -b, --brew         brew
###        --brew-cask    brew cask
###    -p, --pip          python3 packages
###        --apt          apt packages
###    -a, --all          everything

upgrade_brew_cask() {
    if [[ "$(uname -s)" == "Darwin" ]]; then
        _info "begin to upgrade brew cask"
        brew upgrade
        brew cask reinstall `brew cask outdated`
        _success " end to upgrade brew cask packages\n"
    fi
}
upgrade_brew() {
    if [[ "$(uname -s)" == "Darwin" ]]; then
        _info "begin to upgrade brew packages"
        brew upgrade
        brew upgrade `brew outdated`
        _success "end to upgrade brew packages\n"
    fi
}
upgrade_pip() {
    _info "begin to upgrade python3 packages"
    pip3 freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs pip3 install -U
    _success "end to upgrade python3 packages\n"
}
upgrade_apt() {
    if [[ "$(uname -s)" == "Linux" ]]; then
        _info "begin to upgrade apt packages"
        sudo apt-get upgrade -y
        sudo apt-get upgrade -y
        sudo apt-get dist-upgrade
        _success "end to upgrade apt packages\n"
    fi
}

case "$1" in
    "-b" | "--brew" )
        upgrade_brew
        ;;
    "--brew-cask" )
        upgrade_brew_cask
        ;;
    "-p" | "--pip" )
        upgrade_pip
        ;;
    "--apt" )
        upgrade_apt
        ;;
    "-a" | "--all" )
        upgrade_brew
        upgrade_pip
        upgrade_apt
        ;;
    * )
        _print_help "$(realpath $0)" -h
        ;;
esac
